# Infraa koodina

### x) Lue ja tiivistä:
- **[Hello Salt Infra-as-Code](https://terokarvinen.com/2024/hello-salt-infra-as-code/)**
  - Asenna Salt komennoilla `sudo apt-get update` ja `sudo apt-get -y install salt-minion`
  - Asenna micro-editori ja aseta se oletuseditoriksi komennoilla `sudo apt-get -y install micro` ja `export EDITOR=micro`
  - Luo kansio ”hello” moduulille komennolla `sudo mkdir -p /srv/salt/hello/` ja siirry sinne komennolla `cd /srv/salt/hello/`
    - /svr/salt/ on kaikille minioneille jaettu kansio. Kun moduuli ajetaan, niin Salt etsii hello-kansion ja suorittaa sen init.sls-tiedoston.
  - Kun olet hello-kansiossa, niin luo sinne init.sls tiedosto komennolla `sudoedit init.sls’`
  - Lisää tiedostoon seuraava sisältö ja tallenna:
         `/tmp/hellotero:
            file.managed`
  - Testataan moduulin toimintaa ajamalla se paikallisesti komennolla `sudo salt-call --local state.apply hello`
    - Moduulin tulisi luoda tiedosto /tmp/hellotero
  - Voit varmistaa, että moduuli loi toivotun tiedoston komennolla `ls /tmp/hellotero`

- **[Salt contributors](https://docs.saltproject.io/salt/user-guide/en/latest/topics/overview.html#rules-of-yaml)**
  - Rules of YAML
    - Salt käyttää YAML:ia oletuksena tiedostojen renderöinnissä. Se ottaa ensin YAML data rakenteen ja muuntaa sen Python datarakenteeksi, jota Salt voi käyttää.
    - YAML:in säännöt
      - Data esitetään avain-arvo pareissa. Parien muodostamiseen käytetään kaksoispistettä ja välilyöntiä (’avain: arvo’)
      - Avaimen arvo voi olla useissa eri muodoissa/rakenteissa
      - Kirjainkoolla on väliä (esim. ’Matti’ ja ’matti’ tulkitaan eri asioiksi)
      - Ei saa käyttää tabia sisentämiseen, vaan pelkästään välilyöntiä
      - Kommentit alkavat risuaidalla (#)

  - YAML simple structure
    - YAML muodostuu kolmesta peruselementti tyypistä:
      - **Scalar** – avainarvo voi olla numero, merkkijono tai booleani
        - Käytetään yksittäisten arvojen esittämiseen
        - Esim. `vegetables: peas`
      - **Lists** – avainta seuraa lista arvoja, jotka esitetään sisennettyinä
          ```
          sequence_key:    --> 	  vegetables:
            - value1              -  peas
            - value2		          -  carrots
          ```
      - **Dictionary** – pääavaimen alle koottu kokoelma avainarvo pareja ja listoja
      - wef
        
  - Lists and dictionaries - YAML block structures
  - 
  
### a) Hei infrakoodi! Kokeile paikallisesti (esim 'sudo salt-call --local') infraa koodina. Kirjota sls-tiedosto, joka tekee esimerkkitiedoston /tmp/ -kansioon.
- 

### b) Aja esimerkki sls-tiedostosi verkon yli orjalla.
- 

### c) Tee sls-tiedosto, joka käyttää vähintään kahta eri tilafunktiota näistä: package, file, service, user. Tarkista eri ohjelmalla, että lopputulos on oikea. Osoita useammalla ajolla, että sls-tiedostosi on idempotentti.
- 

## Lähteet:
- Karvinen 2025: https://terokarvinen.com/palvelinten-hallinta/#laksyt. Luettu 15.4.2025.
- Karvinen 2014: https://terokarvinen.com/2024/hello-salt-infra-as-code/. Luettu 15.4.2025.
- VMware, Inc 2021: https://docs.saltproject.io/salt/user-guide/en/latest/topics/overview.html#rules-of-yaml. Luettu 15.4.2025.
- educative s.a: https://www.educative.io/answers/how-to-represent-dictionaries-in-yaml. Luettu 15.4.2025.



